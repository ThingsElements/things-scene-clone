import{RectPath as t,Shape as e,Component as r,Model as a}from"@hatiolab/things-scene";const i={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"duration",name:"duration",property:"duration"},{type:"string",label:"target",name:"target",property:"target"},{type:"checkbox",label:"repeat",name:"repeat",property:"repeat"},{type:"checkbox",label:"autostart",name:"autostart",property:"autostart"},{type:"number",label:"targetRetention",name:"targetRetention",property:"targetRetention"}]};class s extends(t(e)){added(t){this.started=!1,setTimeout(()=>{this.get("autostart")&&(this.started=!0)},500)}dispose(){this.started=!1,super.dispose()}_draw(t){var{left:e,top:r,width:a,height:i}=this.bounds;t.beginPath(),t.fillStyle="black",t.strokeStyle="black",t.rect(e,r,.8*a,.8*i),t.fill(),t.stroke(),t.beginPath(),t.rect(e+.2*a,r+.2*i,.8*a,.8*i)}get nature(){return i}get started(){return this._started}set started(t){if(!!this.started!=!!t&&(this._started=!!t,this.app.isViewMode))if(this._started){var{repeat:e,duration:r,target:i,targetRetention:s}=this.model;if(!i)return;r<500&&(r=500);let t=this;requestAnimationFrame(function o(){t._started&&function(t,e,r){var i=t.root.findById(e);if(i){var s=Object.assign(i.hierarchy,{templatePrefix:"",id:""});r&&(s.retention=r);var o=a.compile(s,t.app),n=i.parent.indexOf(i);return i.parent.insertComponentAt(o,n+1),o}}(t,i,s)&&r&&e?t._timeout=setTimeout(()=>{requestAnimationFrame(o)},r):t._started=!1})}else this._timeout&&(clearTimeout(this._timeout),this._timeout=0)}}r.register("clone",s);export{s as Clone};
